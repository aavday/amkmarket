"use strict";var body=document.querySelector("body"),header=document.querySelector(".header"),footer=document.querySelector(".footer"),bodyScrollOff=function(){body.classList.add("lock"),body.style.position="fixed",body.style.width="100%",body.style.top="-".concat(offset,"px")},bodyScrollOn=function(){body.classList.remove("lock"),body.style.position="",body.style.width="",body.style.top="",window.scrollTo({top:offset})},burger=document.querySelector(".burger"),nav=document.querySelector(".header__inner"),main=document.querySelector(".main"),offset=null;burger.addEventListener("click",function(){burger.classList.toggle("active"),nav.classList.toggle("active"),main.classList.toggle("active"),footer.classList.toggle("active"),burger.classList.contains("active")?(offset=pageYOffset,bodyScrollOff()):bodyScrollOn()});var anchors=document.querySelectorAll("a[data-scroll]"),intro=document.querySelector(".intro");intro?anchors.forEach(function(t){t.addEventListener("click",function(e){e.preventDefault();var a=parseInt(getComputedStyle(main).marginTop),r=document.querySelector(t.getAttribute("data-scroll")),o=document.body.getBoundingClientRect().top,c=r.getBoundingClientRect().top-o-a;burger.classList.contains("active")&&(offset="",bodyScrollOn(),burger.classList.toggle("active"),nav.classList.toggle("active"),main.classList.toggle("active"),footer.classList.toggle("active")),0===c&&(anchors.forEach(function(t){t.classList.remove("active")}),document.querySelector('a[data-scroll=".intro"]').classList.add("active")),scrollTo({top:c,behavior:"smooth"})})}):anchors.forEach(function(t){var e=t.getAttribute("href"),a=t.getAttribute("data-scroll").replace(".","");t.setAttribute("href","".concat(e,"#").concat(a))}),intro&&pageYOffset<intro.scrollHeight/2&&(anchors.forEach(function(t){t.classList.remove("active")}),document.querySelector('a[data-scroll=".intro"]').classList.add("active"));var catalogue=document.querySelector(".catalogue"),categories=document.querySelector(".categories"),cart=document.querySelector(".cart");if(catalogue||categories?document.querySelector('.header__nav-list-item a[href$="/kategorii"]').classList.add("active"):cart?document.querySelector('.header__nav-list-item a[href$="/korzina"]').classList.add("active"):window.addEventListener("scroll",function(){document.querySelectorAll(".section").forEach(function(t){var e=t.getBoundingClientRect().top+pageYOffset-300,a=e+t.scrollHeight,r=window.pageYOffset,o=t.getAttribute("id");r>e&&r<a&&(anchors.forEach(function(t){t.classList.remove("active")}),document.querySelector('a[data-scroll=".'.concat(o,'"]')).classList.add("active"))})}),document.querySelector(".intro__slider"))var introSlider=tns({container:".intro__slider",items:1,autoplay:!0,autoplayButtonOutput:!1,controls:!1,navPosition:"bottom",mouseDrag:!0});if(document.querySelector(".feedback__slider"))var feedbackSlider=tns({container:".feedback__slider",items:1,autoplay:!0,autoplayButtonOutput:!1,controls:!1,navPosition:"bottom",mouseDrag:!0});var catalogueImgsSliderInit=function(){tns({container:".catalogue__card-imgs-slider",items:1,autoplay:!1,autoplayButtonOutput:!1,controls:!1,navPosition:"bottom",mouseDrag:!0})},modal=document.querySelector(".modal"),modalClose=document.querySelector(".modal-close"),modalOn=function(){offset=pageYOffset,bodyScrollOff(),modal.classList.toggle("active"),window.innerWidth>1400&&(body.style.paddingRight="17px",footer.style.paddingRight="17px",footer.style.width="calc(100% + 17px)")},modalOff=function(){bodyScrollOn(),modal.classList.toggle("active"),window.innerWidth>1400&&(body.style.paddingRight="0",footer.style.paddingRight="0",footer.style.width="auto")};modal&&modalClose.addEventListener("click",function(){modalOff(),deliveryCompaniesDisplayNone()});var modalLinks=document.querySelectorAll(".modal-link");modalLinks.forEach(function(t){t.addEventListener("click",function(){modalOn()})});var deliveryCompanies=document.querySelectorAll(".delivery-company");deliveryCompanies&&deliveryCompanies.forEach(function(t){t.addEventListener("click",function(){modalOn();var e=t.classList[0].replace("-logo","");document.querySelector(".".concat(e,"-iframe")).classList.remove("d-none")})});var deliveryCompaniesDisplayNone=function(){document.querySelectorAll(".modal iframe").forEach(function(t){t.classList.add("d-none")})},itemsArray=[],updateArray=function(){var t=document.querySelectorAll(".catalogue__table-item");itemsArray=[],t.forEach(function(t){var e={};e.name=t.querySelector(".catalogue__table-item-name").textContent.trim(),e.price=t.querySelector(".catalogue__table-item-price").textContent.trim(),e.article=t.querySelector(".catalogue__table-item-article").textContent.trim(),e.thumb=t.querySelector(".catalogue__table-item-thumb div").style.backgroundImage,t.classList.contains("filtered")?e.filtered="filtered":e.filtered="",itemsArray.push(e)})};updateArray();var sortText=function(t,e){return t.name<e.name?-1:t.name<e.name?1:void 0},sortNum=function(t,e){return e.price-t.price},sortByName=function(t){"name-down"===t?itemsArray.sort(sortText):itemsArray.sort(sortText).reverse(),updateList(itemsArray)},sortByPrice=function(t){"price-down"===t?itemsArray.sort(sortNum):itemsArray.sort(sortNum).reverse(),updateList(itemsArray)},catalogueTable=document.querySelector(".catalogue__table tbody"),updateList=function(t){catalogueTable.innerHTML="",t.forEach(function(t){catalogueTable.innerHTML+='\n      <tr class="catalogue__table-item '.concat(t.filtered,'">\n        <td class="catalogue__table-item-thumb">\n            <div style=\'background-image: ').concat(t.thumb,';\' alt=""></div>\n        </td>\n        <td class="catalogue__table-item-name">\n            ').concat(t.name,'\n        </td>\n        <td class="catalogue__table-item-article">\n          ').concat(t.article,'\n        </td>\n        <td class="catalogue__table-item-price">\n            ').concat(t.price,'<i class="ml-1 fas fa-ruble-sign"></i>\n        </td>\n      </tr>\n    ')}),itemsAddListener()},sortPriceBtn=document.querySelector(".catalogue__sort-by-price"),sortNameBtn=document.querySelector(".catalogue__sort-by-name");sortNameBtn&&sortNameBtn.addEventListener("click",function(t){t.preventDefault(),sortPriceBtn.classList.remove("down","up"),sortNameBtn.classList.contains("down")?(sortByName("name-up"),sortNameBtn.classList.remove("down"),sortNameBtn.classList.add("up")):(sortByName("name-down"),sortNameBtn.classList.add("down"))}),sortPriceBtn&&sortPriceBtn.addEventListener("click",function(t){t.preventDefault(),sortNameBtn.classList.remove("down","up"),sortPriceBtn.classList.contains("down")?(sortByPrice("price-up"),sortPriceBtn.classList.remove("down"),sortPriceBtn.classList.add("up")):(sortByPrice("price-down"),sortPriceBtn.classList.add("down"))});var filterItems=function(t){Array.from(catalogueTable.children).filter(function(e){return!e.textContent.toLowerCase().includes(t)}).forEach(function(t){return t.classList.add("filtered")}),Array.from(catalogueTable.children).filter(function(e){return e.textContent.toLowerCase().includes(t)}).forEach(function(t){return t.classList.remove("filtered")})},search=document.querySelector(".catalogue__search");search&&search.addEventListener("keyup",function(){var t=search.value.trim().toLowerCase();filterItems(t),updateArray()});var catalogueCardEmpty=document.querySelector(".catalogue__card-empty"),catalogueCardContent=document.querySelector(".catalogue__card-content"),catalogueCardArticle=document.querySelector(".catalogue__card-article"),catalogueCardName=document.querySelector(".catalogue__card-name"),catalogueCardImgs=document.querySelector(".catalogue__card-imgs"),catalogueCardPrice=document.querySelector(".catalogue__card-price"),catalogueCardDescription=document.querySelector(".catalogue__card-description"),catalogueCardAmount=document.querySelector(".catalogue__card-add-to-cart-amount"),updateCard=function(t,e,a,r,o){catalogueCardAmount.value=1,catalogueCardEmpty.classList.add("d-none"),catalogueCardContent.classList.remove("d-none"),catalogueCardArticle.textContent=t,catalogueCardName.textContent=e,catalogueCardPrice.innerHTML="".concat(r,'<i class="ml-1 fas fa-ruble-sign"></i>'),catalogueCardDescription.textContent=o,catalogueCardImgs.innerHTML='\n    <div class="catalogue__card-imgs-slider slider">\n\n    </div>\n  ';var c=document.querySelector(".catalogue__card-imgs-slider");a.forEach(function(t){c.innerHTML+='\n      <div class="item">\n        <img src="'.concat(t,'" alt="" class="catalogue__card-img">\n      </div>\n    ')}),catalogueImgsSliderInit(),itemAdded()},itemsAddListener=function(){var t=document.querySelectorAll(".catalogue__table-item"),e="",a="",r=[],o="",c="",n=document.querySelectorAll(".catalogue__info-item");t.forEach(function(t){t.addEventListener("click",function(){e=t.querySelector(".catalogue__table-item-article").textContent.trim(),a=t.querySelector(".catalogue__table-item-name").textContent.trim(),o=t.querySelector(".catalogue__table-item-price").textContent.trim(),console.log(o),n.forEach(function(t){if(t.querySelector(".catalogue__info-article").textContent.trim()===e&&t.querySelector(".catalogue__info-name").textContent.trim()===a&&t.querySelector(".catalogue__info-price").textContent.trim()===o){c=t.querySelector(".catalogue__info-description").textContent;var n=t.querySelectorAll(".catalogue__info-img");r=[],n.forEach(function(t){r.push(t.textContent)})}}),updateCard(e,a,r,o,c)})})};itemsAddListener();var addToCartLink=document.querySelector(".catalogue__card-add-to-cart"),addToCartAmount=document.querySelector(".catalogue__card-add-to-cart-amount"),addToCartArray=[];JSON.parse(localStorage.getItem("cart-items"))&&(addToCartArray=JSON.parse(localStorage.getItem("cart-items")));var addToCartObj={};addToCartLink&&addToCartLink.addEventListener("click",function(){if((addToCartObj={}).name=catalogueCardName.textContent.trim(),addToCartObj.price=catalogueCardPrice.textContent.trim(),addToCartObj.amount=addToCartAmount.value,addToCartObj.article=catalogueCardArticle.textContent,JSON.stringify(addToCartArray).includes(addToCartObj.article)){for(var t=null,e=0;e<addToCartArray.length&&!addToCartArray[e].article.includes(addToCartObj.article);e++)t++;addToCartArray.splice(t,1)}addToCartArray.push(addToCartObj),localStorage.setItem("cart-items",JSON.stringify(addToCartArray)),itemAdded()});var itemAdded=function(){JSON.stringify(addToCartArray).includes(catalogueCardArticle.textContent)?(catalogueCardContent.querySelector(".fa-shopping-cart").classList.add("d-none"),catalogueCardContent.querySelector(".fa-check").classList.remove("d-none")):(catalogueCardContent.querySelector(".fa-shopping-cart").classList.remove("d-none"),catalogueCardContent.querySelector(".fa-check").classList.add("d-none"))},cartTable=document.querySelector(".cart__table");if(cart){var checkIfCartEmpty=function(){0===addToCartArray.length&&(cart.querySelector(".cart-empty").classList.remove("d-none"),cart.querySelector(".cart-active").classList.add("d-none"))};checkIfCartEmpty();var items=JSON.parse(localStorage.getItem("cart-items"));items.forEach(function(t){cartTable.innerHTML+='\n      <tr class="cart__table-item">\n        <td class="cart__table-item-name">\n            '.concat(t.name,'\n        </td>\n        <td class="cart__table-item-article">\n            ').concat(t.article,'\n        </td>\n        <td class="cart__table-item-price">\n            ').concat(t.price,'<i class="ml-1 fas fa-ruble-sign"></i>\n        </td>\n        <td class="cart__table-item-quantity">\n          <input type="number" class="cart__table-item-quantity-input" name="amount" value="').concat(t.amount,'" min="1">\n        </td>\n        <td class="cart__table-item-delete">\n          <i class="fas fa-times"></i>\n        </td>\n      </tr>\n    ')});var cartTableItems=document.querySelectorAll(".cart__table-item");cartTableItems.forEach(function(t){var e=t.querySelector(".cart__table-item-quantity");e.addEventListener("change",function(){updateAmount(e.parentElement,e.querySelector("input").value),updateTotalCost()});var a=t.querySelector(".cart__table-item-delete");a.addEventListener("click",function(t){t.preventDefault(),deleteCartItem(a.parentElement),updateTotalCost()})});var updateForm=function(){var t=document.querySelectorAll(".cart__table-item"),e=document.querySelector(".cart__order-form-info"),a=document.querySelector(".cart__order-total-cost").textContent;e.value="",t.forEach(function(t){var a=t.querySelector(".cart__table-item-name").textContent.trim(),r=t.querySelector(".cart__table-item-article").textContent.trim(),o=t.querySelector(".cart__table-item-price").textContent.trim(),c=t.querySelector(".cart__table-item-quantity-input").value;e.value+="Назв.: ".concat(a,", Арт.: ").concat(r,", Цена за шт.: ").concat(o,", Кол-во: ").concat(c,"\n")}),e.value+="Итого: ".concat(a)},totalCostTag=document.querySelector(".cart__order-total-cost"),updateTotalCost=function(){var t=document.querySelectorAll(".cart__table-item"),e=0;t.forEach(function(t){var a=t.querySelector(".cart__table-item-price").textContent.trim(),r=t.querySelector(".cart__table-item-quantity-input").value;e+=a*r}),totalCostTag.innerHTML="".concat(e,'<i class="ml-1 fas fa-ruble-sign"></i>'),updateForm()};updateTotalCost();var updateAmount=function(t,e){for(var a=0,r=0;r<addToCartArray.length;r++){var o=t.querySelector(".cart__table-item-article").textContent.trim();if(addToCartArray[r].article.includes(o))break;a++}addToCartArray[a].amount=e,localStorage.setItem("cart-items",JSON.stringify(addToCartArray)),updateForm()},deleteCartItem=function(t){t.remove();for(var e=0,a=0;a<addToCartArray.length;a++){var r=t.querySelector(".cart__table-item-article").textContent.trim();if(addToCartArray[a].article.includes(r))break;e++}addToCartArray.splice(e,1),localStorage.setItem("cart-items",JSON.stringify(addToCartArray)),updateForm(),checkIfCartEmpty()}}